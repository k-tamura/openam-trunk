<?xml version="1.0" encoding="UTF-8"?>
<!--
  ! CCPL HEADER START
  !
  ! This work is licensed under the Creative Commons
  ! Attribution-NonCommercial-NoDerivs 3.0 Unported License.
  ! To view a copy of this license, visit
  ! http://creativecommons.org/licenses/by-nc-nd/3.0/
  ! or send a letter to Creative Commons, 444 Castro Street,
  ! Suite 900, Mountain View, California, 94041, USA.
  !
  ! You can also obtain a copy of the license at
  ! src/main/resources/legal-notices/CC-BY-NC-ND.txt.
  ! See the License for the specific language governing permissions
  ! and limitations under the License.
  !
  ! If applicable, add the following below this CCPL HEADER, with the fields
  ! enclosed by brackets "[]" replaced with your own identifying information:
  !      Portions Copyright [yyyy] [name of copyright owner]
  !
  ! CCPL HEADER END
  !
  !      Copyright 2011-2013 ForgeRock, Inc.
  !    
-->
<chapter xml:id='chap-custom'
 xmlns='http://docbook.org/ns/docbook'
 version='5.0' xml:lang='en'
 xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
 xsi:schemaLocation='http://docbook.org/ns/docbook http://docbook.org/xml/5.0/xsd/docbook.xsd'
 xmlns:xlink='http://www.w3.org/1999/xlink'
 xmlns:xinclude='http://www.w3.org/2001/XInclude'>
 <title>Customizing Your OpenAM Deployment</title>
 <indexterm><primary>Customize</primary></indexterm>
 
 <para>Most users want to customize their OpenAM deployments to make them appear
 consistent with the webpages they protect. This chapter provides instructions to
 help amend your existing customized files to a new version. Customization is
 universal across all of the different versions, whether an upgrade, update, or
 patch.</para>
 
 <procedure xml:id="update-custom">
  <title>To Customize An OpenAM Deployment</title>
  
  <step>
   <para>Verify that the JAVA_HOME is properly set.</para>
  </step>

  <step>
   <para>Create a new directory and expand your current <filename>.war</filename> file
   so that you can copy your customized files.</para>
  </step>

  <step>
   <para>Download the upgrade file from the <link 
   xlink:show="new" xlink:href="http://forgerock.com/openam-downloads/"
   ><citetitle>Enterprise Downloads page</citetitle></link>. You can either download the 
   <filename>.zip</filename> or the <filename>.war</filename> files. If you use the 
   tools or some of the other components provided in the <filename>.zip</filename>, 
   you may want to download it.</para>
  </step>

  <step>
   <para>Create a second new directory near your customized expanded 
   <filename>.war</filename> and expand the update <filename>.war</filename> file.</para>
  </step>

  <step>
   <para>Copy your customized files from your expanded <filename>.war</filename> 
   file and replace those files in the expanded update <filename>.war</filename> file.</para>
  </step>

  <step>
   <para>Rebuild the update <filename>.war</filename> file</para>
  </step>
 
 </procedure>

 <itemizedlist>
  <para>Once you have customized your file, click on one of the following links to
  finish the applicable process:</para>
   
   <listitem>
    <para><link xlink:href="upgrade-guide#chap-patches"
     xlink:role="http://docbook.org/xlink/role/olink">
     <citetitle>Applying A Patch</citetitle></link></para>
   </listitem>

   <listitem>
    <para><link xlink:href="upgrade-guide#chap-update-basics"
     xlink:role="http://docbook.org/xlink/role/olink">
     <citetitle>Updating An OpenAM Deployment</citetitle></link></para>
   </listitem>
   
   <listitem>
    <para><link xlink:href="upgrade-guide#chap-upgrade-basics"
     xlink:role="http://docbook.org/xlink/role/olink">
     <citetitle>Upgrading An OpenAM Deployment</citetitle></link></para>
   </listitem>
      
   <listitem>
    <para><link xlink:href="upgrade-guide#chap-legacy"
     xlink:role="http://docbook.org/xlink/role/olink">
     <citetitle>Upgrading Legacy OpenAM Deployments</citetitle></link></para>
   </listitem>

 </itemizedlist>


 <example xml:id="custom-example">
 <?dbfo keep-together="auto"?>
  <title>Customize An OpenAM 10.1.0 Deployment</title>
  <para>The following example updates OpenAM 10.0.0 to OpenAM 10.1.0  
  on an Ubuntu instance. <!-- TO DO The <citetitle>Deployment Guide</citetitle> provides more 
  information for other containers and platforms.--> The example only addresses the 
  <filename>.war</filename> file. Review the <citetitle>Installation Guide</citetitle> 
  to reinstall the tools following a successful update.</para>
  
  <orderedlist numeration="arabic">
  <listitem>
   <para>Verify that the JAVA_HOME is properly set.</para>
   <screen>echo $JAVA_HOME
 /path/to/java-6-sun</screen>
  </listitem>

  <listitem>
   <para>Create a new directory and expand your current <filename>.war</filename>.</para>
   <screen>$ cd /path/above/openam
$ mkdir expanded-openam-war ; cd expanded-openam-war
$ mkdir current-war ; cd current-war
$ jar xvf /path/to/tomcat/webapps/openam.war</screen>
  </listitem>

  <listitem>
   <para>Download the OpenAM 10.1.0 <filename>.war</filename> from the 
  <link xlink:show="new" xlink:href="http://forgerock.com/openam-downloads/"
  ><citetitle>Enterprise Downloads</citetitle></link> page.</para>
  </listitem>

  <listitem>
   <para>Create a new directory to expand the OpenAM 10.1.0 <filename>.war</filename> 
   file.</para>
   <screen>$ cd /path/to/expanded-openam-war
$ mkdir update-war ; cd update-war
$ jar xvf ~/Downloads/openam-server-10.1.0.war</screen>
  </listitem>

  <listitem>
   <para>Add your customized content to the web app content.</para>
  </listitem>

  <listitem>
   <para>Rebuild the update <filename>.war</filename> file</para>
   <screen>$ jar cvf openam.war *</screen>
  </listitem>

 </orderedlist>

 </example>

</chapter>